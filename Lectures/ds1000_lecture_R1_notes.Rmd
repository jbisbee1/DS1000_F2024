---
title: "Review 1 Notes"
output: html_document
date: "2024-01-25"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Testing Pset 3 Data

- This following chunk of code will open the data from github and then manipulate it in the following ways:
  - convert Trump favorability to numeric
  - Convert trump favorability to text

```{r}
rm(list = ls())
require(tidyverse)

# This line opens the raw data from github
dat <- read_rds("https://github.com/jbisbee1/DS1000_S2024/raw/main/data/MI2020_ExitPoll.rds")


dat <- dat %>%
  mutate(FAVTRUMP = as.numeric(haven::as_factor(FAVTRUMP))) %>%
  mutate(fav_trump_text = ifelse(FAVTRUMP == 1,
                                 "Approve",
                                 ifelse(FAVTRUMP == 2,
                                        "Disapprove",
                                        "Refuse")))

dat %>%
  mutate(na_trump = ifelse(is.na(FAVTRUMP),'THis is NA','THis is not NA')) %>%
  count(FAVTRUMP,na_trump)

dat
```

# Digging into research-ey questions

```{r}
dat %>%
  count(fav_trump_text)

# Manually
220 / (220+385+10)

# Using code
dat %>%
  count(fav_trump_text) %>%
  filter(!is.na(fav_trump_text)) %>%
  mutate(totVoters = sum(n)) %>%
  mutate(prop = n / totVoters)

```

# RQ: Relationship between Age and Trump Approval

```{r}
dat %>%
  filter(!is.na(fav_trump_text)) %>%
  select(AGE10,fav_trump_text) %>%
  count(AGE10,fav_trump_text) %>%
  group_by(AGE10) %>%
  mutate(totResp = sum(n)) %>%
  ungroup() %>%
  mutate(prop = n / totResp) %>%
  filter(fav_trump_text == "Approve") %>%
  filter(AGE10 < 99) %>%
  ggplot(aes(x = AGE10,
             y = prop)) + 
  geom_point() + 
  geom_smooth(method = 'lm',se = FALSE)
  #geom_bar(stat = 'identity')
```


